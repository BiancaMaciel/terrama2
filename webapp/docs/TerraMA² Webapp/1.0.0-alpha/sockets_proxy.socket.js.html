<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: sockets/proxy.socket.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-terrama2.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: sockets/proxy.socket.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Proxy module for Cross-Domain requests.
 * @module proxy
 */
module.exports = function(io) {
  var sockets = io.sockets,
      http = require('http');

  sockets.on('connection', function(client) {
    client.on('proxyRequest', function(json) {
      http.get(json.url, function(resp){
        var xml = '';

        resp.on('data', function(chunk) {
          xml += chunk;
        });

        resp.on('end', function() {
          xml = xml.replace(/>\s*/g, '>');
          xml = xml.replace(/\s*&lt;/g, '&lt;');

          sockets.emit('proxyResponse', { msg: xml, requestId: json.requestId });
        });

      }).on("error", function(e){
        console.log("Got error: " + e.message);
      });
    });
  });
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><div style="margin-left: 20px;"><h2>sockets</h2><ul><li><a href="module-proxy.html">proxy</a></li></ul></div><div style="margin-left: 20px;"><h2>public/javascripts</h2><ul><li><a href="Config.html">Config</a></li><li><a href="TerraMA2.html">TerraMA2</a></li></ul></div><div style="margin-left: 20px;"><h2>public/javascripts/components</h2><ul><li><a href="LayerExplorer.html">LayerExplorer</a></li><li><a href="LeftBar.html">LeftBar</a></li><li><a href="MapDisplay.html">MapDisplay</a></li><li><a href="ToolBox.html">ToolBox</a></li></ul></div>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.0</a> on Wed Jan 13 2016 15:38:28 GMT-0200 (BRST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
